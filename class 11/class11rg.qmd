---
title: "class 11: structural bioinformatics pt1"
author: "Rachel Galleta (A:16859649)"
format: pdf
toc: true
---

## AlphaFold Data Base (AFBD)

the EBI maintains the largest database of Alphafold structure prediction models at: 

from last class (before Halloween) we saw that the PDB had 244,290 (Oct 2025)

the total number of proteins sequences in UniprotKB is 199,579,901.

>Key point:This is a tiny fraction of sequence space that has structural coverage (0.12%)

```{r}
244290/199579901*100
```

AFDB is attenting to address this gap..

There are two "Quality Scores" from the  Alphafold one for residues (ie, each amino acid) called pLDDT score. The other PAE score that measures the confidence in the relative position of two residues(i.e a score for every )

## Generating your own structure predictions

figure of 5 generated HIV PR 

![](HVPR_dimer1.png)


![](HVPR_dimer2.png)



![](HVPR_dimer3.png)

pLDDT score for model 1 

![](HVPR_dimer4.png)

## Custom analysis of resulting models in R

Read Key result files into R, The first thing I need to know is what my results directory /folder is called.

```{r}
results_dir <-"HIVPR_dimer_23119"
pdb_files <- list.files(path=results_dir,
                        pattern="*.pdb",
                        full.names = TRUE)

# Print our PDB file names
basename(pdb_files)

```

```{r}
library(bio3d)

m1<- read.pdb(pdb_files[1])
m1

m1_A <- trim.pdb(m1, chain = "A")
m1_A
```
```{r}
unique(m1$atom$chain)

```



```{r}

pdbs <- pdbaln(pdb_files, fit=TRUE, exefile="msa")
pdbs
```


```{r}
plotb3(m1$atom$b[m1$calpha])
```


## Residue conservation from alignment file

```{r}
aln_file <- list.files(path=results_dir,
                       pattern=".a3m$",
                        full.names = TRUE)
aln_file
```

```{r}
aln <- read.fasta(aln_file[1], to.upper = TRUE)
```
```{r}
dim(aln$ali)
```


```{r}
sim <- conserv(aln)

plotb3(sim[1:99],(m1$atom$b[m1$calpha]) ,
       sse=m1_A,
       ylab="Conservation Score")
```

```{r}
con <- consensus(aln, cutoff = 0.9)
con$seq
```





