---
title: "Class 12"
author: "rachel galleta"
format: html
---


```{r}
counts <- read.csv("airway_scaledcounts.csv", row.names=1)
metadata <-read.csv("airway_metadata.csv")
```

```{r}
head(counts)
```
Q1. How many genes are in this dataset? 

```{r}
nrow(counts)
```

Q2. How many ‘control’ cell lines do we have? 

```{r}
sum(metadata$dex=="control")
```

## Toy differential gene expression

To start our analysis lets calculate the mean for all genes in the "control" experiments.

1. extract all "control" columns form the counts objets 
2. Calculate the mean for all rows (ie, genes) of these "control"  columns 
3-4. Do the same for "treated"
5. Compare these "control.mean" and "treated.mean" values.

```{r}
#1.
control.inds <- metadata$dex=="control"
control.counts<- counts[,control.inds]
```


```{r}
#2.
control.means <- rowMeans( control.counts)
```

```{r}
dim(control.counts)
```


```{r}
#3-4.
treated.inds <- metadata$dex=="treated"
treated.counts<- counts[,treated.inds]
treated.means <- rowMeans(treated.counts)
```


store these together for ease of book means counts

```{r}
#5.
meancounts <- data.frame(control.means, treated.means)
head(meancounts)
```
mamke a plot onf ocntorl vs treatments menad valeues for all genes

```{r}
plot(meancounts)
```

Make this a log plot

```{r}
plot(meancounts,log="xy")
```

we often talk about metrics like "log2 fold-change"

```{r}
#treated/control
log2(10/10)
```

```{r}
log2(10/20)
```

```{r}
log2(20/10)
```

```{r}
log2(40/10)
log2(10/40)
```
lets calculate the log2 fold change four our treated over control mean counts

```{r}
meancounts$log2fc<-
log2(meancounts$treated.means/
  meancounts$control.means)
```

```{r}
head(meancounts)
```
A common "rule of thumb" is a log2 fold change cutoff of +2 and -2 to call genes "up regulated" or "down regulated"

Number of "up" genes
```{r}
sum(meancounts$log2fc >= +2, na.rm=T)
```

number of "down" genes at -2 threshold

```{r}
sum(meancounts$log2fc <= -2, na.rm=T)
```
##DESeq2 analysis

lest do  this analysis properlty and keep our inner starts nerd happy are the teh diferrenes we seen and no drug significnat givne the replciate experimnet

```{r,message=FALSE}
library(DESeq2)
```


